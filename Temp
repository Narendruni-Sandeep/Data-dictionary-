private int getLineIndexFromCaret(int caretPos) {
    String textUpToCaret = employeeTextArea.getText().substring(0, caretPos);
    int lineIndex = 0;
    for (char ch : textUpToCaret.toCharArray()) {
        if (ch == '\n') lineIndex++;
    }
    return lineIndex; // 0-based line index
}
